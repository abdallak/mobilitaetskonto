sap.ui.define([
	"Mobilitaetskonto/Mobilitaetskonto/controller/BaseController"
], function (BaseController) {
	"use strict";
	return BaseController.extend("Mobilitaetskonto.Mobilitaetskonto.controller.Antrag", {

		onInit: function () {},

		antragStellen: function (oEvent) {
			//This code was generated by the layout editor.

			var dbUserModel = this.getGlobalModel("dbUserModel").getData();

			var params = {};
			params.mid = dbUserModel.MID;
			params.art = this.getView().byId("art").getSelectedKey();
			params.betrag = this.getView().byId("betrag").getValue();
			params.beschreibung = this.getView().byId("beschreibung").getValue();
			if (params.betrag === "") {
				sap.m.MessageToast.show("Bitte Betrag eingeben!");
				return;
			}

			var oAntragModel = new sap.ui.model.json.JSONModel();
			oAntragModel.loadData("/MOB_ANTRAG", params);

			var that = this;
			oAntragModel.attachRequestCompleted(function (oEvent1) {
				that.getRouter().navTo("Umsatz");
			});
		},

		/**
		 *@memberOf Mobilitaetskonto.Mobilitaetskonto.controller.Antrag
		 */
		onBetragChanged: function (oEvent) {
			//This code was generated by the layout editor.

			var oResourceBundle = this.getView().getModel("i18n").getResourceBundle();
			var sValue = oEvent.getParameter("value");
			var oSource = oEvent.getSource();

			if (sValue && sValue.trim().length > 0) {
				oSource.setValueState("Success");
				oSource.setValueStateText(null);
			} else {
				oSource.setValueState("Error");
				oSource.setValueStateText(oResourceBundle.getText("errorEmptyBetrag"));
			}
		}
	});
});

// https://medium.com/@stermi/sapui5-for-dummies-part-5-a-complete-step-by-step-exercise-dcf5f5ae4ca9